# 0908_youtube_live

[TOC]

## 1. Static file

> ì •ì  íŒŒì¼
>
> ì‘ë‹µí•  ë•Œ ë³„ë„ ì²˜ë¦¬ ì—†ì´ íŒŒì¼ ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ëŠ” íŒŒì¼
>



### Static file êµ¬ì„±

1. django.contrib.staticfilesê°€ INSTALLED_APPSì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ -> `ì´ë¯¸ ë˜ì–´ìˆìŒ`
2. settings.pyì—ì„œ STATIC_URLì„ ì •ì˜ -> `ì´ë¯¸ ë˜ì–´ìˆìŒ`
3. í…œí”Œë¦¿ì—ì„œ static í…œí”Œë¦¿ íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ ìƒëŒ€ê²½ë¡œì— ëŒ€í•œ URLì„ ë¹Œë“œ
4. ì•±ì˜ static í´ë”ì— ì •ì  íŒŒì¼ì„ ì €ì¥ -> **apps/templates ì™€ ë¹„ìŠ·!**



- load : ì‚¬ìš©ì ì •ì˜ íƒ¬í”Œë¦¿ íƒœê·¸ ì„¸íŠ¸ë¥¼ ë¡œë“œ, íŒ¨í‚¤ì§€ì— ë“±ë¡ëœ ëª¨ë“  íƒœê·¸ì™€ í•„í„°ë¥¼ ë¡œë“œ
- static : STATIC_ROOTì— ì €ì¥ëœ ì •ì  íŒŒì¼ì— ì—°ê²°
- STATIC_ROOT : collectstaticì´ **ë°°í¬ë¥¼ ìœ„í•´** ì •ì  íŒŒì¼ì„ ìˆ˜ì§‘í•˜ëŠ” ë””ë ‰í† ë¦¬ì˜ ì ˆëŒ€ ê²½ë¡œ
  - DEBUG : Trueì¼ ë•ŒëŠ” í•´ë‹¹ ê°’ì´ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
- 

![image-20210908093819850](0908.assets/image-20210908093819850.png)

![image-20210908094042113](0908.assets/image-20210908094042113.png)

```
$ python manage.py collectstatic
```

- ì¥ê³  í”„ë¡œì íŠ¸ì—ì„œ ì‹¤ì„œë¹„ìŠ¤ë¡œ ë°°í¬í•  ë•Œ ì¥ê³  ì„œë²„ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì„œë²„ì—ì„œ êµ¬ë™ë˜ê¸° ë•Œë¬¸ì— **ì •ì íŒŒì¼ë“¤ì— ëŒ€í•œ ê²½ë¡œë¥¼ í•œ ê³³ì— ëª¨ìœ¼ëŠ” ëª…ë ¹ì–´**

![image-20210909094417150](0908.assets/image-20210909094417150.png)

- ìƒˆë¡œìš´ í´ë”ê°€ ìƒê¸°ê³  129ê°œì˜ íŒŒì¼ì´ ìƒì„±ëë‹¤ê³  ë‚˜ì˜´

-> ë‹¹ì¥ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í•„ìš” ì—†ìŒ (ë‚˜ì¤‘ì— ë°°í¬í•  ë•Œ í•„ìš”í•¨)



- STATIC_URL : STATIC_ROOTì— ìˆëŠ” ì •ì  íŒŒì¼ì„ ì°¸ì¡°í•  ë•Œ ì‚¬ìš©í•˜ëŠ” URL
  - {% static 'zzang-a.png' %} ê°™ì€ ê²½ë¡œì— "/static/zzang-a.png"ë¡œ ë°”ê¿”ì£¼ëŠ” íš¨ê³¼
  - ì‹¤ì œ íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ê°€ ì•„ë‹ˆë©°, URLë¡œë§Œ ì¡´ì¬í•œë‹¤. ëë‚¼ ë•Œ ìŠ¬ë˜ì‰¬(/)ë¡œ ëë‚˜ì•¼ í•œë‹¤!
- STATICFILES_DIRS : app/static/ ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ì™¸ì— ì¶”ê°€ì ì¸ ì •ì íŒŒì¼ ê²½ë¡œ ëª©ë¡ì„ ì •ì˜í•˜ëŠ” ë¦¬ìŠ¤íŠ¸ (ì „ì—­ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ!)
- ì‹¤ìŠµ

### ì‚¬ì§„ ë„£ê¸°

#### ì²«ë²ˆì§¸ ë°©ë²•

> ì•± í´ë” ë‚´ì— static í´ë”ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ì§„ ê°€ì ¸ì˜¤ê¸°

![image-20210908094849968](0908.assets/image-20210908094849968.png)

- appë‚´ì— static í´ë” ë§Œë“¤ê¸° - app ì´ë¦„ì˜ í´ë”ë¥¼ í•˜ë‚˜ ë” ë§Œë“¦

![image-20210908095005697](0908.assets/image-20210908095005697.png)

```html
{% extends 'base.html' %} # ì–´ë–¤ ê²ƒì´ ì™€ë„ ìµœìƒë‹¨ì— ìœ„ì¹˜í•´ì•¼ í•¨
{% load static %} # ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•¨
```

![image-20210908095217755](0908.assets/image-20210908095217755.png)

- ì´ë¯¸ì§€ íƒœê·¸ë¥¼ ë‹¬ì•„ì¤¬ë‹¤!

``` python
python manage.py runserver
```

- ì„œë²„ë¥¼ ì—´ì–´ì£¼ë©´ ì‚¬ì§„ì´ ë‚˜ì˜¨ë‹¤!

<img src="0908.assets/image-20210908095945931.png" alt="image-20210908095945931" style="zoom:67%;" />

#### ë‘ë²ˆì§¸ ë°©ë²•

> ìµœìƒë‹¨ í´ë”ì— ìˆëŠ” static ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°

![image-20210908100209039](0908.assets/image-20210908100209039.png)

- settings.pyë¶€í„° ì •ì˜í•´ì£¼ê³ 

![image-20210908100344525](0908.assets/image-20210908100344525.png)

```
{% load static %}
<img src="{% static 'images/whatrudoing.png' %}" alt="sample img second">
```

- í•´ì£¼ë©´ base.htmlì„ ìƒì†í•˜ëŠ” íŒŒì¼ì€ ë‹¤ ì´ ì‚¬ì§„ì´ ë³´ì¸ë‹¤!

<img src="0908.assets/image-20210908100448431.png" alt="image-20210908100448431" style="zoom:67%;" />

## 2. ì´ë¯¸ì§€ ì—…ë¡œë“œ (ê¸°ë³¸ ì„¤ì •)

### Media file

> ìœ ì €ê°€ ì—…ë¡œë“œ í•œ ëª¨ë“  ì •ì  íŒŒì¼(user-uploaded)

#### ImageField

- ImageField : ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‚¬ìš©í•˜ëŠ” **ëª¨ë¸ í•„ë“œ**

  - FileFieldë¥¼ ìƒì†ë°›ëŠ” ì„œë¸Œ í´ë˜ìŠ¤
  - ImageField ì¸ìŠ¤í„´ìŠ¤ëŠ” ìµœëŒ€ ê¸¸ì´ê°€ 100ìì¸ ë¬¸ìì—´ë¡œ DBì— ìƒì„±ë¨
    - max_lengthë¥¼ ì´ìš©í•´ ìµœëŒ€ ê¸¸ì´ ë³€ê²½ ê°€ëŠ¥
  - [ì£¼ì˜] Pillow ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•¨

  ![image-20210908105820088](0908.assets/image-20210908105820088.png)

- blank=True : ì‚¬ìš©ìê°€ ì‚¬ì§„ì„ ì—…ë¡œë“œ í•˜ì§€ ì•Šì•„ë„ ìœ íš¨ì„± ê²€ì‚¬ì— ê±¸ë¦¬ì§€ ì•Šë„ë¡!
  
- null : ë°ì´í„°ê°€ ì—†ìŒ(ë¹ˆ ê°’ì„ ë„£ëŠ” ê²ƒ) -> `ë¬¸ìì—´ ê¸°ë°˜ í•„ë“œ(CharField, TextField)ì—ì„œëŠ” ì‚¬ìš© í•˜ì§€ ë§ì`
  
- FileField : íŒŒì¼ ì—…ë¡œë“œì— ì‚¬ìš©í•˜ëŠ” ëª¨ë¸ í•„ë“œ
  
  - ë‘ ê°œì˜ ì„ íƒ ì¸ìë¥¼ ê°€ì§€ê³  ìˆìŒ
    - **upload_to** : ë¬¸ìì—´ ê°’ì´ë‚˜ ê²½ë¡œ ì§€ì •, í•¨ìˆ˜ í˜¸ì¶œ
    - storage

![image-20210909103904250](0908.assets/image-20210909103904250.png)

- ìë™ìœ¼ë¡œ ìƒê²¨ë”°ì•„ ğŸ¤©

#### Media

- MEDIA_ROOT : **ì‚¬ìš©ìê°€ ì—…ë¡œë“œ í•œ íŒŒì¼ë“¤ì„ ë³´ê´€**í•  ë””ë ‰í† ë¦¬ì˜ ì ˆëŒ€ ê²½ë¡œ(**ê²½ë¡œë§Œ!!!!**)

![image-20210908105913434](0908.assets/image-20210908105913434.png)

- MEDIA_URL : MEDIA_ROOTì—ì„œ ì œê³µë˜ëŠ” ë¯¸ë””ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” URL
  - ì—…ë¡œë“œëœ íŒŒì¼ì˜ ì£¼ì†Œë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• 
  - ë°˜ë“œì‹œ ìŠ¬ë˜ì‰¬(/)ë¡œ ëë‚˜ì•¼ í•¨
  - MEDIA_URLê³¼ STATIC_URLì€ ë‹¤ë¥¸ ê²½ë¡œë¡œ ëë‚˜ì•¼ í•¨

![image-20210908105941451](0908.assets/image-20210908105941451.png)

![image-20210909112707017](0908.assets/image-20210909112707017.png)

```html
enctype="multipart/form-data"
```



![image-20210909104757880](0908.assets/image-20210909104757880.png)

- ì¸ì½”ë”© íƒ€ì… ìˆ˜ì •
- accpet ì„ íƒí•  ìˆ˜ ìˆìŒ (.jpg, .pdf ë“± ì„ íƒ ê°€ëŠ¥)
- https://developer.mozilla.org/ko/docs/Web/HTML/Element/Input/file#htmlattrdefwebkitdirectory_non-standard_inline

![image-20210909105156368](0908.assets/image-20210909105156368.png)

- 20ë²ˆì§¸ ì¤„
- í‚¤ì›Œë“œ ì¸ì ë’¤ì— ìœ„ì¹˜ ì¸ìëŠ” ë¶ˆê°€ëŠ¥ í•¨!
- í‚¤ì›Œë“œ ì“¸ê±°ë©´ ë‹¤ ì“°ì ğŸ˜ 
- https://docs.djangoproject.com/ko/3.2/howto/static-files/#serving-files-uploaded-by-a-user-during-development
- ëª©ì°¨ : ê°œë°œ ì¤‘ì— ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ì„ ì œê³µí•©ë‹ˆë‹¤.

![image-20210908110159935](0908.assets/image-20210908110159935.png)

```
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    # ... the rest of your URLconf goes here ...
] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

![image-20210908110237742](0908.assets/image-20210908110237742.png)

- project/urls.py íŒŒì¼ì— ìˆ˜ì •í•´ì£¼ë©´ ë¨

-> MEDIA_ROOT, MEDIA_URL, settings.py ê´€ë¦¬ í•´ì£¼ë©´ ë



## 3. ì´ë¯¸ì§€ ì—…ë¡œë“œ (CREATE)



- ImageField ì‘ì„±
  - upload_to = 'images/' : ì‹¤ì œ ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ëŠ” ê²½ë¡œë¥¼ ì§€ì •

![image-20210908110657828](0908.assets/image-20210908110657828.png)

```
$ pip install pillow
```

![image-20210908110728510](0908.assets/image-20210908110728510.png)

- requirements.txtì— ì €ì¥í•´ì£¼ê¸°

![image-20210908110814818](0908.assets/image-20210908110814818.png)

- makemigrations

![image-20210908110923743](0908.assets/image-20210908110923743.png)

- migrate

![image-20210908110951634](0908.assets/image-20210908110951634.png)

- image í•„ë“œ ìƒê²¨ë”°



![image-20210908111013412](0908.assets/image-20210908111013412.png)



#### blank & null ë¹„êµ



![image-20210908111048056](0908.assets/image-20210908111048056.png)



- blank = True : ì´ë¯¸ì§€ í•„ë“œì— ë¹ˆ ê°’ì´ í—ˆìš©ë˜ë„ë¡ ì„¤ì •
  - blankì˜ ê¸°ë³¸ ê°’ : False, ìœ íš¨ì„± ê²€ì‚¬ì—ì„œ ì‚¬ìš© ë¨(is_valid)

- multipart/form-data : file ë°˜ë“œì‹œ ì‚¬ìš©í•´ì•¼ í•¨

![image-20210908111444724](0908.assets/image-20210908111444724.png)

- ì´ë ‡ê²Œ í•´ë„ ì—¬ì „íˆ ì‚¬ì§„ ì•ˆ ì˜¬ë¼ê°€ì§... ëŒ€ì²´ ì™œ?!?!!
- views.py ì•ˆ ê³ ì³ë†“ê³  í™”ë‚´ëŠ” ì¤‘... 

![image-20210908141121307](0908.assets/image-20210908141121307.png)

```
form = ArticleForm(request.POST, request.FILES) #20ë²ˆì§¸ ì¤„
```



![image-20210908141231799](0908.assets/image-20210908141231799.png)

- ì´ë¯¸ì§€ ì—…ë¡œë“œê°€ ëë‹¤!
- ì°¸ê³ ) ê°™ì€ ì´ë¦„ì˜ íŒŒì¼ì´ ì—…ë¡œë“œ ë˜ì–´ë„ ì‹ ê²½ì“°ì§€ ì•Šì•„ë„ ë¨

![image-20210908141407531](0908.assets/image-20210908141407531.png)



- detail.htmlì—ì„œ ì´ë¯¸ì§€ê°€ ë³´ì´ë„ë¡ ë§Œë“¤ê¸°

![image-20210908141840865](0908.assets/image-20210908141840865.png)

```
<img src="{{ article.image.url }}" alt="{{ article.image }} ">
```



## 4. ì´ë¯¸ì§€ ì—…ë¡œë“œ(UPDATE)

> create ë¿ë§Œ ì•„ë‹ˆë¼ updateë„ ê°€ëŠ¥í•´ì•¼í•˜ë‹ˆê¹Œ ìˆ˜ì •í•´ì£¼ì!

- update.htmlì„ ë¨¼ì € ìˆ˜ì •í•´ì£¼ì

![image-20210908142459451](0908.assets/image-20210908142459451.png)

```
<form action="{% url 'articles:update' article.pk %}" method="POST" enctype="multipart/form-data">
```

- views.pyë¥¼ ìˆ˜ì •í•˜ì

![image-20210908142649338](0908.assets/image-20210908142649338.png)

- ì‰ ë¹¨ê°„ì¤„ ?_?

![image-20210908142952578](0908.assets/image-20210908142952578.png)

- ì´ë ‡ê²Œê°€ ìˆœì„œì„! (ì•„ë‹ˆë©´ ëª…ì‹œì ìœ¼ë¡œ ë­”ì§€ ë‹¤ ì ì–´ì£¼ê±°ë‚˜...) -> í‚¤ì›Œë“œ ì¸ìê°€ ìœ„ì¹˜ì¸ì ì•ì— ê°ˆ ìˆ˜ ì—†ë‹¤..



## 5. ì‚¬ì§„ì´ ì—†ëŠ” detail ì°½ì´ ì˜¤ë¥˜ê°€ ë‚œë‹¤ ã…œã…œ

![image-20210908143541752](0908.assets/image-20210908143541752.png)

- ëŒ€ì²´ ì–´ë–¡í•˜ë¼ê³ ì˜¤ì˜¤ì˜¤ì˜¤ã…—ã…‡ì˜¤!!!!! ë¼ê³  ì†Œë¦¬ì¹˜ê¸° ì „ì— ë‹¤ì‹œ detail.htmlì„ ë³´ì

![image-20210908143614718](0908.assets/image-20210908143614718.png)

- ë¶„ëª… imgê°€ ì—†ëŠ” ìƒì„¸í˜ì´ì§€ë„ ìˆì„ í…ë° ìŸ¤ëŠ” ë¬´ì¡°ê±´ imgë¥¼ ë¶ˆëŸ¬ì˜¤ë¼ê³  í•œë‹¤ ??

![image-20210908143717499](0908.assets/image-20210908143717499.png)

- ifë¬¸ìœ¼ë¡œ ìˆ˜ì •í•´ì£¼ì

<img src="0908.assets/image-20210908143734061.png" alt="image-20210908143734061" style="zoom:67%;" />

- ë–´ë‹¹! íˆíˆ



### ì‚¬ì§„ì„ ë‚ ì§œëŒ€ë¡œ ì €ì¥ì‹œí‚¤ê¸°

#### ì²«ë²ˆì§¸ ë°©ë²•

![image-20210909113821233](0908.assets/image-20210909113821233.png)

- models.pyì—ì„œ upload_toë¥¼ %Y/%m/%d/ í˜•ì‹ìœ¼ë¡œ ë³€ê²½ì‹œí‚¤ê¸°

```python
# classë‚´ì— ê³ ì³ì£¼ê¸°
	image = models.ImageField(blank=True, upload_to='%Y/%m/%d/')
```



#### ë‘ë²ˆì§¸ ë°©ë²•

> ëª¨ë¸ì— í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°

![image-20210909114113930](0908.assets/image-20210909114113930.png)

```python
def article_file_path(instance, filename):
    return f'articles_{instance.pk}/{filename}'
```

```python
# classë‚´ì— ê³ ì³ì£¼ê¸°
    image = models.ImageField(blank=True, upload_to=article_file_path)
```



## 6. ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•

- ì°¸ê³  URL : https://github.com/matthewwithanm/django-imagekit

![image-20210909114638021](0908.assets/image-20210909114638021.png)

- ì„¤ì¹˜í•´ì£¼ê¸°

![image-20210909114711581](0908.assets/image-20210909114711581.png)

- INSTALLED_APPSì— `'imagekit',` ë„£ê¸°

![image-20210909132833653](0908.assets/image-20210909132833653.png)

- ìˆ˜ì •í•´ì£¼ê¸°

#### ì¸ë„¤ì¼ ë§Œë“¤ê¸°

![image-20210909133542553](0908.assets/image-20210909133542553.png)



![image-20210909134137372](0908.assets/image-20210909134137372.png)

- ì™œ ì¸ë„¤ì¼ì´ ì•ˆë‚˜ì˜¬ê¹Œ... ã…œã…œ

#### ê²Œì‹œê¸€ì´ ì‚­ì œë˜ë©´ ì‚¬ì§„ë„ ì‚­ì œë˜ê²Œ ë§Œë“¤ê¸°

![image-20210909134236121](0908.assets/image-20210909134236121.png)

- `django-cleanup` íŒ¨í‚¤ì§€ ì„¤ì¹˜í•´ì£¼ê¸°

![image-20210909134305003](0908.assets/image-20210909134305003.png)

- ì•±ë“±ë¡ì„ í•´ì¤€ë‹¤. -> `INSTALLED_APPS = 'django_cleanup'`



## 7. ë©”ì„¸ì§€ í”„ë ˆì„ì›Œí¬

![image-20210909141334285](0908.assets/image-20210909141334285.png)

- settings.pyì— ì½”ë“œë¥¼ ë¶™ì—¬ë„£ëŠ”ë‹¤.

``` python
MESSAGE_STORAGE = 'django.contrib.messages.storage.session.SessionStorage'
```



![image-20210909141137990](0908.assets/image-20210909141137990.png)



![image-20210909141218808](0908.assets/image-20210909141218808.png)





![image-20210909141815438](0908.assets/image-20210909141815438.png)



```html
{% if messages %}
  <ul class="messages">
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">
        {{ message.message }}
      </div>
      {% endfor %}
  </ul>
  {% endif %}
```
